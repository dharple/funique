#
# Goal:
# * Test currently supported and recently sunsetted versions of both
#   Symfony and PHP.
# * Test future releases of both.
#

language: php
php:
  - 7.2
  - 7.3
  - 7.4
  - 8.0
  - nightly

allow_failures:
  - php: nightly

before_script:
  - jq 'del(."require-dev")' composer.json > composer-ci.json
  - COMPOSER=composer-ci.json composer require --dev phpunit/phpunit

script:
  - composer install
  - composer test
  - composer install --no-dev -o
  - php -d phar.readonly=0 bin/compile

cache:
  directories:
  - $HOME/.cache/composer/files
