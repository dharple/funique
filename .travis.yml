#
# Goal:
# * Test currently supported and recently sunsetted versions of both
#   Symfony and PHP.
# * Test future releases of both.
#

language: php
dist: xenial
os: linux
php:
  - 7.2
  - 7.3
  - 7.4
  - 8.0
  - nightly

before_script:
  - sudo apt-get update
  - sudo apt-get -y install xmlstarlet
  - xmlstarlet ed -d phpunit/coverage phpunit.xml.dist > phpunit.xml
  - jq 'del(."require-dev")' composer.json > composer-ci.json
  - COMPOSER=composer-ci.json composer require --dev phpunit/phpunit

script:
  - COMPOSER=composer-ci.json composer install
  - vendor/bin/phpunit
  - composer install --no-dev -o
  - php -d phar.readonly=0 bin/compile

cache:
  directories:
  - $HOME/.cache/composer/files
